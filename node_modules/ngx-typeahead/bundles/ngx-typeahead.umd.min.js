!function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?factory(exports,require("@angular/core"),require("@angular/common"),require("@angular/common/http"),require("rxjs/add/operator/debounceTime"),require("rxjs/add/operator/concat"),require("rxjs/add/operator/distinctUntilChanged"),require("rxjs/add/operator/share"),require("rxjs/add/operator/filter"),require("rxjs/add/operator/map"),require("rxjs/add/operator/switchMap"),require("rxjs/add/observable/fromEvent"),require("rxjs/Observable")):"function"==typeof define&&define.amd?define(["exports","@angular/core","@angular/common","@angular/common/http","rxjs/add/operator/debounceTime","rxjs/add/operator/concat","rxjs/add/operator/distinctUntilChanged","rxjs/add/operator/share","rxjs/add/operator/filter","rxjs/add/operator/map","rxjs/add/operator/switchMap","rxjs/add/observable/fromEvent","rxjs/Observable"],factory):factory((global.ng=global.ng||{},global.ng.ngxTypeahead={}),global.ng.core,global.ng.common,global.ng.commmon.http,global.Rx.Observable.prototype,global.Rx.Observable.prototype,global.Rx.Observable.prototype,global.Rx.Observable.prototype,global.Rx.Observable.prototype,global.Rx.Observable.prototype,global.Rx.Observable.prototype,global.Rx.Observable.prototype,global.Rx)}(this,function(exports,core,common,http,debounceTime,concat,distinctUntilChanged,share,filter,map,switchMap,fromEvent,Observable){"use strict";function validateNonCharKeyCode(keyCode){return[Key.Enter,Key.Tab,Key.Shift,Key.ArrowLeft,Key.ArrowUp,Key.ArrowRight,Key.ArrowDown,Key.MacCommandLeft,Key.MacCommandRight,Key.MacCommandFirefox].every(function(codeKey){return codeKey!==keyCode})}function validateArrowKeys(keyCode){return keyCode===Key.ArrowDown||keyCode===Key.ArrowUp}function isIndexActive(index,currentIndex){return index===currentIndex}function createParamsForQuery(query,queryParamKey,customParams){void 0===queryParamKey&&(queryParamKey="q"),void 0===customParams&&(customParams={});var searchParams=__assign((_a={},_a[queryParamKey]=query,_a),customParams);return Object.keys(searchParams).reduce(function(acc,param){return acc.set(param,searchParams[param])},new http.HttpParams);var _a}function resolveApiMethod(method){return void 0===method&&(method=""),["get","post","put","delete","patch","request"].some(function(methodName){return method===methodName})?method:"get"}function resolveNextIndex(currentIndex,stepUp){var currentResultIndex=currentIndex+(stepUp?1:-1),resultIndex=currentResultIndex;return 10===currentResultIndex&&(resultIndex=0),-1===currentResultIndex&&(resultIndex=9),resultIndex}var __assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p])}return t},Key={Backspace:8,Tab:9,Enter:13,Shift:16,Escape:27,ArrowLeft:37,ArrowRight:39,ArrowUp:38,ArrowDown:40,MacCommandLeft:91,MacCommandRight:93,MacCommandFirefox:224};Key[Key.Backspace]="Backspace",Key[Key.Tab]="Tab",Key[Key.Enter]="Enter",Key[Key.Shift]="Shift",Key[Key.Escape]="Escape",Key[Key.ArrowLeft]="ArrowLeft",Key[Key.ArrowRight]="ArrowRight",Key[Key.ArrowUp]="ArrowUp",Key[Key.ArrowDown]="ArrowDown",Key[Key.MacCommandLeft]="MacCommandLeft",Key[Key.MacCommandRight]="MacCommandRight",Key[Key.MacCommandFirefox]="MacCommandFirefox";var NgxTypeAheadComponent=function(){function NgxTypeAheadComponent(element,viewContainer,http$$1,cdr){this.element=element,this.viewContainer=viewContainer,this.http=http$$1,this.cdr=cdr,this.showSuggestions=!1,this.taUrl="",this.taParams={},this.taQueryParam="q",this.taApi="jsonp",this.taApiMethod="get",this.taList=[],this.taSelected=new core.EventEmitter,this.suggestionIndex=0}return NgxTypeAheadComponent.prototype.handleEsc=function(event){event.keyCode===Key.Escape&&(this.hideSuggestions(),event.preventDefault())},NgxTypeAheadComponent.prototype.ngOnInit=function(){var onkeyDown$=this.onElementKeyDown();this.subscriptions=[this.filterEnterEvent(onkeyDown$),this.listenAndSuggest(),this.navigateWithArrows(onkeyDown$)],this.renderTemplate()},NgxTypeAheadComponent.prototype.ngOnDestroy=function(){this.subscriptions.forEach(function(sub){return sub.unsubscribe()}),this.subscriptions.length=0},NgxTypeAheadComponent.prototype.renderTemplate=function(){this.viewContainer.createEmbeddedView(this.suggestionsTplRef),this.cdr.markForCheck()},NgxTypeAheadComponent.prototype.onElementKeyDown=function(){return Observable.Observable.fromEvent(this.element.nativeElement,"keydown").share()},NgxTypeAheadComponent.prototype.filterEnterEvent=function(elementObs){var _this=this;return elementObs.filter(function(e){return e.keyCode===Key.Enter}).subscribe(function(event){event.preventDefault(),_this.handleSelectSuggestion(_this.activeResult)})},NgxTypeAheadComponent.prototype.listenAndSuggest=function(){var _this=this;return Observable.Observable.fromEvent(this.element.nativeElement,"keyup").filter(function(e){return validateNonCharKeyCode(e.keyCode)}).map(function(e){return e.target.value}).debounceTime(300).concat().distinctUntilChanged().filter(function(query){return query.length>0}).switchMap(function(query){return _this.suggest(query)}).subscribe(function(results){_this.results=results,_this.showSuggestions=!0,_this.suggestionIndex=0,_this.cdr.markForCheck()})},NgxTypeAheadComponent.prototype.navigateWithArrows=function(elementObs){var _this=this;return elementObs.filter(function(e){return validateArrowKeys(e.keyCode)}).map(function(e){return e.keyCode}).subscribe(function(keyCode){_this.suggestionIndex=resolveNextIndex(_this.suggestionIndex,keyCode===Key.ArrowDown),_this.showSuggestions=!0,_this.cdr.markForCheck()})},NgxTypeAheadComponent.prototype.suggest=function(query){return this.taList.length?this.createListSource(this.taList):this.request(query)},NgxTypeAheadComponent.prototype.request=function(query){var url=this.taUrl,options={params:createParamsForQuery(query,this.taQueryParam,this.taParams)};return"jsonp"===this.taApi?this.requestJsonp(url,options,this.taCallbackParamValue):this.requestHttp(url,options)},NgxTypeAheadComponent.prototype.requestHttp=function(url,options){var apiMethod=resolveApiMethod(this.taApiMethod),responseTransformMethod=this.taResponseTransform||function(item){return item};return this.http[apiMethod](url,options).map(function(results){return results.map(responseTransformMethod)})},NgxTypeAheadComponent.prototype.requestJsonp=function(url,options,callback){void 0===callback&&(callback="callback");var params=options.params.toString();return this.http.jsonp(url+"?"+params,callback).map(function(response){return response[1]}).map(function(results){return results.map(function(result){return result[0]})})},NgxTypeAheadComponent.prototype.markIsActive=function(index,result){var isActive=isIndexActive(index,this.suggestionIndex);return isActive&&(this.activeResult=result),isActive},NgxTypeAheadComponent.prototype.handleSelectSuggestion=function(suggestion){this.hideSuggestions(),this.taSelected.emit(suggestion)},NgxTypeAheadComponent.prototype.hideSuggestions=function(){this.showSuggestions=!1},NgxTypeAheadComponent.prototype.hasItemTemplate=function(){return void 0!==this.taItemTpl},NgxTypeAheadComponent.prototype.createListSource=function(list){return new Observable.Observable(function(observer){observer.next(list)})},NgxTypeAheadComponent.decorators=[{type:core.Component,args:[{selector:"[ngxTypeahead]",styles:["\n  .results {\n    position: absolute;\n  }\n  .typeahead-backdrop {\n    bottom: 0;\n    left: 0;\n    position: fixed;\n    right: 0;\n    top: 0;\n    z-index: 1;\n  }\n  .list-group-item {\n    position: relative;\n    z-index: 2;\n  }\n  "],template:'\n  <ng-template #suggestionsTplRef>\n  <section class="list-group results" *ngIf="showSuggestions">\n    <div class="typeahead-backdrop" (click)="hideSuggestions()"></div>\n    <button type="button" class="list-group-item"\n      *ngFor="let result of results; let i = index;"\n      [class.active]="markIsActive(i, result)"\n      (click)="handleSelectSuggestion(result)">\n      <span *ngIf="!taItemTpl"><i class="fa fa-search"></i> {{ result }}</span>\n      <ng-template\n        [ngTemplateOutlet]="taItemTpl"\n        [ngTemplateOutletContext]="{ $implicit: {result: result, index: i} }"\n      ></ng-template>\n    </button>\n  </section>\n  </ng-template>\n  '}]}],NgxTypeAheadComponent.ctorParameters=function(){return[{type:core.ElementRef},{type:core.ViewContainerRef},{type:http.HttpClient},{type:core.ChangeDetectorRef}]},NgxTypeAheadComponent.propDecorators={taItemTpl:[{type:core.Input}],taUrl:[{type:core.Input}],taParams:[{type:core.Input}],taQueryParam:[{type:core.Input}],taCallbackParamValue:[{type:core.Input}],taApi:[{type:core.Input}],taApiMethod:[{type:core.Input}],taResponseTransform:[{type:core.Input}],taList:[{type:core.Input}],taSelected:[{type:core.Output}],suggestionsTplRef:[{type:core.ViewChild,args:["suggestionsTplRef"]}],handleEsc:[{type:core.HostListener,args:["keydown",["$event"]]}]},NgxTypeAheadComponent}(),NgxTypeaheadModule=function(){function NgxTypeaheadModule(){}return NgxTypeaheadModule.decorators=[{type:core.NgModule,args:[{declarations:[NgxTypeAheadComponent],exports:[NgxTypeAheadComponent,common.CommonModule],imports:[common.CommonModule,http.HttpClientModule,http.HttpClientJsonpModule],providers:[]}]}],NgxTypeaheadModule.ctorParameters=function(){return[]},NgxTypeaheadModule}();exports.NgxTypeaheadModule=NgxTypeaheadModule,exports.Éµa=NgxTypeAheadComponent,Object.defineProperty(exports,"__esModule",{value:!0})});